#! /usr/bin/env ruby

Main {
  argument('tag'){
    optional true
  }

  option('--launchy', '-l'){
    description 'open url with launchy gem'
    default false
  }

  def run
    if params['tag'].given?
      tag = params['tag'].value
      url = Fukung.tag(tag).sort_by{ rand }.first
    else
      url = Fukung.random
    end

    if params['launchy'].given?
      url = Shellwords.escape(url)
      Launchy.open(url)
    else
      puts(url)
    end
  end
}




BEGIN {
  require 'shellwords'

  begin
    require 'rubygems'
  rescue LoadError
  end

  require 'fukung'
  require 'main'
  require 'launchy'
}
